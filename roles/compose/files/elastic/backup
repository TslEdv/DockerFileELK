FROM ubuntu:latest

# Install required packages
RUN apt-get update && apt-get install -y \
    openjdk-11-jdk \
    wget \
    gnupg2 \
    && rm -rf /var/lib/apt/lists/*

# Install Elasticsearch
RUN wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | apt-key add -
RUN echo "deb https://artifacts.elastic.co/packages/8.x/apt stable main" > /etc/apt/sources.list.d/elastic-8.x.list
RUN apt-get update && apt-get install -y elasticsearch && rm -rf /var/lib/apt/lists/*

# Set environment variables
ENV node.name=es
ENV cluster.name=es-cluster
ENV ES_JAVA_OPTS="-Xms1g -Xmx1g"
ENV discovery.seed_hosts=elasticsearch1,elasticsearch2,elasticsearch3
ENV cluster.initial_master_nodes=es1,es2,es3

# Expose ports
EXPOSE 9200

# Start Elasticsearch
CMD ["elasticsearch"]
